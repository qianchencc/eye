#!/bin/bash

# =================å¤šè¯­è¨€æ”¯æŒ (Centralized Messages)=================
_init_messages() {
    if [[ "$LANGUAGE" == "zh" ]] || [[ "$LANGUAGE" == "Chinese" ]]; then
        LANG_MODE="zh"
    elif [[ "$LANGUAGE" == "en" ]] || [[ "$LANGUAGE" == "English" ]]; then
        LANG_MODE="en"
    elif [[ -z "$LANGUAGE" ]]; then
        if [[ "$LANG" == zh* ]]; then
            LANG_MODE="zh"
        else
            LANG_MODE="en"
        fi
    else
        LANG_MODE="en"
    fi

    if [ "$LANG_MODE" == "zh" ]; then
        MSG_USAGE_HEADER="ç”¨æ³•: eye <command> [args]"
        MSG_USAGE_CORE="æ ¸å¿ƒå‘½ä»¤:"
        MSG_USAGE_CMD_START="  start            å¯åŠ¨æŠ¤çœ¼åå°è¿›ç¨‹"
        MSG_USAGE_CMD_STOP="  stop             åœæ­¢æŠ¤çœ¼è¿›ç¨‹ (ä¼˜é›…é€€å‡º)"
        MSG_USAGE_CMD_KILL="  kill             å¼ºåˆ¶æ€æ­»æ‰€æœ‰è¿›ç¨‹å¹¶é‡ç½®çŠ¶æ€ (ç›¸å½“äºå½»åº•æ¸…é™¤)"
        MSG_USAGE_CMD_PAUSE="  pause <time>     æš‚åœæŠ¤çœ¼æ¨¡å¼æŒ‡å®šæ—¶é•¿ (ä¾‹å¦‚: 1h, 30m, 1h30m)"
        MSG_USAGE_CMD_RESUME="  resume           å–æ¶ˆæš‚åœï¼Œç«‹å³æ¢å¤"
        MSG_USAGE_CMD_PASS="  pass <time>      è·³è¿‡æŒ‡å®šç­‰å¾…æ—¶é—´ (è®©ä¸‹æ¬¡ä¼‘æ¯æå‰åˆ°æ¥)"
        MSG_USAGE_CMD_STATUS="  status           æŸ¥çœ‹å½“å‰çŠ¶æ€"
        MSG_USAGE_CMD_NOW="  now [--reset]    ç«‹å³æ‰§è¡Œä¸€æ¬¡æŠ¤çœ¼æé†’ (--reset é‡ç½®è®¡æ—¶å™¨)"
        MSG_USAGE_CMD_SET="  set <gap> <look> è®¾ç½®æ—¶é—´é—´éš”å’Œè¿œçœºæ—¶é•¿ (æ”¯æŒå•ä½ s, m, h)\n                   ä¾‹å¦‚: eye set 20m 20s"
        MSG_USAGE_CMD_LANG="  language <lang>  è®¾ç½®è¯­è¨€ (English/Chinese)"
        MSG_USAGE_CMD_AUTOSTART="  autostart [on|off] ç®¡ç†å¼€æœºè‡ªå¯ (systemd)"
        MSG_USAGE_AUDIO="éŸ³é¢‘ç®¡ç† (eye sound ...):"
        MSG_USAGE_CMD_SOUND_LIST="  sound list              åˆ—å‡ºæ‰€æœ‰å¯ç”¨éŸ³æ•ˆ"
        MSG_USAGE_CMD_SOUND_PLAY="  sound play <tag>        è¯•å¬æŒ‡å®šæ ‡ç­¾çš„éŸ³æ•ˆ"
        MSG_USAGE_CMD_SOUND_SET="  sound set <start> <end> è®¾ç½®å¼€å§‹å’Œç»“æŸçš„æç¤ºéŸ³"
        MSG_USAGE_CMD_SOUND_ADD="  sound add <tag> <path>  æ·»åŠ è‡ªå®šä¹‰éŸ³é¢‘æ–‡ä»¶"
        MSG_USAGE_CMD_SOUND_RM="  sound rm  <tag>         åˆ é™¤è‡ªå®šä¹‰éŸ³æ•ˆ"
        MSG_USAGE_CMD_SOUND_SWITCH="  sound on|off            å…¨å±€å¼€å¯æˆ–å…³é—­å£°éŸ³"
        
        MSG_START_ALREADY_RUNNING="âš ï¸  æŠ¤çœ¼æ¨¡å¼å·²åœ¨è¿è¡Œä¸­ (PID: %s)"
        MSG_START_STARTED="âœ… æŠ¤çœ¼æ¨¡å¼å·²å¯åŠ¨"
        MSG_STOP_STOPPED="ğŸ›‘ å·²åœæ­¢"
        MSG_STOP_NOT_RUNNING="âš ï¸  æœªè¿è¡Œ"
        MSG_KILL_DONE="âœ… å·²å¼ºåˆ¶æ¸…é™¤æ‰€æœ‰è¿›ç¨‹å¹¶é‡ç½®çŠ¶æ€"
        MSG_PAUSE_SPECIFY_DURATION="âŒ è¯·æŒ‡å®šæ—¶é•¿ (å¦‚ 1h, 30m)"
        MSG_PAUSE_PAUSED="â¸ï¸  æŠ¤çœ¼æ¨¡å¼æš‚åœ %s (ç›´åˆ° %s)"
        MSG_PAUSE_ERROR_FORMAT="âŒ æ ¼å¼é”™è¯¯ã€‚ç¤ºä¾‹: 1h, 30m, 10s"
        MSG_RESUME_RESUMED="â–¶ï¸  æš‚åœå·²å–æ¶ˆï¼Œæ¢å¤è¿è¡Œ"
        MSG_RESUME_NOT_PAUSED="âš ï¸  å½“å‰æœªå¤„äºæš‚åœçŠ¶æ€"
        MSG_PASS_ERROR="âŒ è¯·æŒ‡å®šæ—¶é—´ (å¦‚ 10m)"
        MSG_PASS_SKIPPED="â© å·²è·³è¿‡ %s (ä¼‘æ¯å°†æå‰åˆ°æ¥)"
        MSG_PASS_TRIGGERED="âš¡ï¸ æ—¶é—´ç´¯ç§¯å·²è¶…é™ï¼Œç«‹å³è§¦å‘ä¼‘æ¯ï¼"
        MSG_NOW_MANUAL_RESET="âœ… å·²è§¦å‘æ‰‹åŠ¨æ”¾æ¾ï¼Œè®¡æ—¶å™¨å·²é‡ç½®ã€‚"
        MSG_NOW_MANUAL_TRIGGERED="âœ… å·²è§¦å‘æ‰‹åŠ¨æ”¾æ¾ã€‚"
        MSG_NOW_MANUAL_NO_RESET="ğŸ”” å•æ¬¡æ”¾æ¾æ‰§è¡Œå®Œæ¯•ã€‚(æ³¨æ„ï¼šæŠ¤çœ¼æœåŠ¡å½“å‰å¤„äºå…³é—­çŠ¶æ€)"
        MSG_NOW_TRIGGERING="ğŸ”„ æ­£åœ¨è§¦å‘è¿œçœº..."
        MSG_STATUS_RUNNING="ğŸŸ¢ è¿è¡Œä¸­ | PID: %s"
        MSG_STATUS_PAUSED_REMAINING="â¸ï¸  [å·²æš‚åœ] å‰©ä½™: %s (ç›´åˆ° %s)"
        MSG_STATUS_STOPPED="ğŸ”´ æœåŠ¡å·²åœæ­¢ (Stopped)"
        MSG_STATUS_KILLED="ğŸ”´ æœåŠ¡æœªè¿è¡Œ (Not Running)"
        MSG_STATUS_STOPPED_HINT="   ğŸ’¡ æç¤º: è¾“å…¥ 'eye start' å¼€å¯æŠ¤çœ¼æ¨¡å¼ï¼Œæˆ– 'eye now' è¿›è¡Œå•æ¬¡æ”¾æ¾ã€‚"
        MSG_STATUS_CONFIG="âš™ï¸  é…ç½®: %s é—´éš” / %s è¿œçœº"
        MSG_STATUS_LAST_REST="â±ï¸  ä¸Šæ¬¡ä¼‘æ¯: %s å‰"
        MSG_STATUS_LAST_REST_FROZEN="â±ï¸  ä¸Šæ¬¡ä¼‘æ¯: %s å‰ (å·²å†»ç»“)"
        MSG_STATUS_SOUND="ğŸ”Š éŸ³æ•ˆ: [%s] -> [%s] (å¼€å…³: %s)"
        MSG_STATUS_LANG="ğŸŒ è¯­è¨€: %s"
        MSG_STATUS_SYSTEMD_ACTIVE="Systemd: å·²æ¿€æ´»"
        MSG_SET_USAGE_HINT="ç”¨æ³•: eye set <é—´éš”> <æ—¶é•¿>\nç¤ºä¾‹: eye set 20m 20s"
        MSG_SET_UPDATED="âœ… é…ç½®å·²æ›´æ–°: é—´éš” %s, è¿œçœº %s"
        MSG_LANG_UPDATED="âœ… è¯­è¨€å·²åˆ‡æ¢ä¸º: %s (Language switched to: %s)"
        MSG_LANG_INVALID="âŒ æ— æ•ˆçš„è¯­è¨€é€‰é¡¹ã€‚è¯·ä½¿ç”¨ 'English' æˆ– 'Chinese'ã€‚"
        MSG_AUTOSTART_ON="âœ… å·²å¼€å¯å¼€æœºè‡ªå¯ (å·²åˆ›å»ºå¹¶å¯ç”¨ systemd æœåŠ¡)"
        MSG_AUTOSTART_OFF="ğŸ›‘ å·²å…³é—­å¼€æœºè‡ªå¯"
        MSG_AUTOSTART_ERROR="âŒ è®¾ç½®å¼€æœºè‡ªå¯å¤±è´¥"
        
        MSG_SOUND_LIST_HEADER="ğŸµ å¯ç”¨éŸ³æ•ˆåˆ—è¡¨ï¼š"
        MSG_SOUND_LIST_BUILTIN="  [å†…ç½®] (ä¸å¯åˆ é™¤)"
        MSG_SOUND_LIST_CUSTOM="  [è‡ªå®šä¹‰]"
        MSG_SOUND_LIST_NONE="  (æ— )"
        MSG_SOUND_LIST_ITEM_NONE="  - none      : é™éŸ³"
        MSG_SOUND_LIST_ITEM_DEFAULT="  - default   : æ ‡å‡†é€šçŸ¥"
        MSG_SOUND_LIST_ITEM_BELL="  - bell      : æ¸…è„†é“ƒå£°"
        MSG_SOUND_LIST_ITEM_COMPLETE="  - complete  : ä»»åŠ¡å®Œæˆ"
        MSG_SOUND_LIST_ITEM_SUCCESS="  - success   : æˆåŠŸéŸ³"
        MSG_SOUND_LIST_ITEM_ALARM="  - alarm     : é—¹é’Ÿ"
        MSG_SOUND_LIST_ITEM_CAMERA="  - camera    : å¿«é—¨å£°"
        MSG_SOUND_LIST_ITEM_DEVICE="  - device    : è®¾å¤‡æ¥å…¥"
        MSG_SOUND_LIST_ITEM_ATTENTION="  - attention : æç¤ºéŸ³"
        
        MSG_SOUND_PLAY_TAG_REQUIRED="âŒ è¯·æŒ‡å®šæ ‡ç­¾"
        MSG_SOUND_PLAY_PLAYING="â–¶ï¸  è¯•å¬ [%s] : %s"
        MSG_SOUND_PLAY_MUTE="ğŸ”‡ (é™éŸ³)"
        MSG_SOUND_PLAY_ERROR="âŒ æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•æ’­æ”¾"
        MSG_SOUND_SET_UPDATED="âœ… éŸ³æ•ˆå·²æ›´æ–°: å¼€å§‹[%s] -> ç»“æŸ[%s]"
        MSG_SOUND_ADD_USAGE="âŒ ç”¨æ³•: eye sound add <tag> <path>"
        MSG_SOUND_ADD_ERROR_BUILTIN="âŒ é”™è¯¯: '%s' æ˜¯å†…ç½®éŸ³æ•ˆï¼Œæ— æ³•è¦†ç›–ã€‚"
        MSG_SOUND_ADD_ERROR_FILE="âŒ é”™è¯¯: æ–‡ä»¶ä¸å­˜åœ¨: %s"
        MSG_SOUND_ADD_CONFIRM_REPLACE="âš ï¸  æ ‡ç­¾ '%s' å·²å­˜åœ¨ï¼Œæ˜¯å¦æ›¿æ¢ï¼Ÿ[y/N] "
        MSG_SOUND_ADD_ADDED="âœ… å·²æ·»åŠ : %s"
        MSG_SOUND_RM_USAGE="âŒ ç”¨æ³•: eye sound rm <tag>"
        MSG_SOUND_RM_ERROR_BUILTIN="âŒ é”™è¯¯: '%s' æ˜¯å†…ç½®éŸ³æ•ˆï¼Œä¸èƒ½åˆ é™¤ã€‚"
        MSG_SOUND_RM_DELETED="ğŸ—‘ï¸  å·²åˆ é™¤éŸ³æ•ˆ: %s"
        MSG_SOUND_RM_NOT_FOUND="âš ï¸  æœªæ‰¾åˆ°è‡ªå®šä¹‰æ ‡ç­¾: %s"
        MSG_SOUND_RM_NO_CUSTOM="âš ï¸  æš‚æ— è‡ªå®šä¹‰é…ç½®"
        MSG_SOUND_ON="ğŸ”Š å£°éŸ³å·²å¼€å¯"
        MSG_SOUND_OFF="ğŸ”‡ å£°éŸ³å·²å…³é—­"
        MSG_SOUND_USAGE="ç”¨æ³•: eye sound [list|play|set|add|rm|on|off]"
        
        MSG_NOTIFY_TITLE_START="ğŸ‘€ æŠ¤çœ¼æ—¶é—´"
        MSG_NOTIFY_BODY_START="å¼€å§‹è¿œçœº %sï¼"
        MSG_NOTIFY_TITLE_END="âœ… è¿œçœºç»“æŸ"
        MSG_NOTIFY_BODY_END="çœ¼ç›ä¼‘æ¯å¥½äº†ï¼Œç»§ç»­åŠ æ²¹å§ï¼"
        MSG_ERROR_INVALID_TIME_FORMAT="é”™è¯¯: æ— æ•ˆçš„æ—¶é—´æ ¼å¼"
        
    else
        # English
        MSG_USAGE_HEADER="Usage: eye <command> [args]"
        MSG_USAGE_CORE="Core Commands:"
        MSG_USAGE_CMD_START="  start            Start the eye protection daemon"
        MSG_USAGE_CMD_STOP="  stop             Stop the eye protection daemon (Graceful)"
        MSG_USAGE_CMD_KILL="  kill             Force kill all processes and reset state"
        MSG_USAGE_CMD_PAUSE="  pause <time>     Pause for a specific duration (e.g., 1h, 30m, 1h30m)"
        MSG_USAGE_CMD_RESUME="  resume           Resume from pause immediately"
        MSG_USAGE_CMD_PASS="  pass <time>      Skip waiting time (advance timer)"
        MSG_USAGE_CMD_STATUS="  status           Show current status"
        MSG_USAGE_CMD_NOW="  now [--reset]    Trigger manual break (--reset to reset timer)"
        MSG_USAGE_CMD_SET="  set <gap> <look> Set interval and look-away duration (units: s, m, h)\n                   Example: eye set 20m 20s"
        MSG_USAGE_CMD_LANG="  language <lang>  Set language (English/Chinese)"
        MSG_USAGE_CMD_AUTOSTART="  autostart [on|off] Manage autostart (systemd)"
        MSG_USAGE_AUDIO="Audio Management (eye sound ...):"
        MSG_USAGE_CMD_SOUND_LIST="  sound list              List all available sounds"
        MSG_USAGE_CMD_SOUND_PLAY="  sound play <tag>        Preview a specific sound"
        MSG_USAGE_CMD_SOUND_SET="  sound set <start> <end> Set start and end sounds"
        MSG_USAGE_CMD_SOUND_ADD="  sound add <tag> <path>  Add a custom audio file"
        MSG_USAGE_CMD_SOUND_RM="  sound rm  <tag>         Remove a custom sound"
        MSG_USAGE_CMD_SOUND_SWITCH="  sound on|off            Turn sound on or off globally"
        
        MSG_START_ALREADY_RUNNING="âš ï¸  Eye protection mode is already running (PID: %s)"
        MSG_START_STARTED="âœ… Eye protection mode started"
        MSG_STOP_STOPPED="ğŸ›‘ Stopped"
        MSG_STOP_NOT_RUNNING="âš ï¸  Not running"
        MSG_KILL_DONE="âœ… All eye processes killed and state reset"
        MSG_PAUSE_SPECIFY_DURATION="âŒ Please specify duration (e.g., 1h, 30m)"
        MSG_PAUSE_PAUSED="â¸ï¸  Eye protection paused for %s (until %s)"
        MSG_PAUSE_ERROR_FORMAT="âŒ Invalid format. Example: 1h, 30m, 10s"
        MSG_RESUME_RESUMED="â–¶ï¸  Pause cancelled, resumed"
        MSG_RESUME_NOT_PAUSED="âš ï¸  Not currently paused"
        MSG_PASS_ERROR="âŒ Please specify time (e.g. 10m)"
        MSG_PASS_SKIPPED="â© Skipped %s (Break will come sooner)"
        MSG_PASS_TRIGGERED="âš¡ï¸ Time limit exceeded, triggering break immediately!"
        MSG_NOW_MANUAL_RESET="âœ… Triggered manual break, timer reset."
        MSG_NOW_MANUAL_TRIGGERED="âœ… Manual break triggered."
        MSG_NOW_MANUAL_NO_RESET="ğŸ”” Manual break finished. (Note: Daemon is stopped)"
        MSG_NOW_TRIGGERING="ğŸ”„ Triggering look-away..."
        MSG_STATUS_RUNNING="ğŸŸ¢ Running | PID: %s"
        MSG_STATUS_PAUSED_REMAINING="â¸ï¸  [Paused] Remaining: %s (until %s)"
        MSG_STATUS_STOPPED="ğŸ”´ Service Stopped"
        MSG_STATUS_KILLED="ğŸ”´ Service Not Running"
        MSG_STATUS_STOPPED_HINT="   ğŸ’¡ Hint: Type 'eye start' to enable, or 'eye now' for a manual break."
        MSG_STATUS_CONFIG="âš™ï¸  Config: %s gap / %s look-away"
        MSG_STATUS_LAST_REST="â±ï¸  Last rest: %s ago"
        MSG_STATUS_LAST_REST_FROZEN="â±ï¸  Last rest: %s ago (Frozen)"
        MSG_STATUS_SOUND="ğŸ”Š Sound: [%s] -> [%s] (Switch: %s)"
        MSG_STATUS_LANG="ğŸŒ Language: %s"
        MSG_STATUS_SYSTEMD_ACTIVE="Systemd: Active"
        MSG_SET_USAGE_HINT="Usage: eye set <gap> <look>\nExample: eye set 20m 20s"
        MSG_SET_UPDATED="âœ… Config updated: Gap %s, Look-away %s"
        MSG_LANG_UPDATED="âœ… Language switched to: %s"
        MSG_LANG_INVALID="âŒ Invalid language option. Please use 'English' or 'Chinese'."
        MSG_AUTOSTART_ON="âœ… Autostart enabled (systemd service created and enabled)"
        MSG_AUTOSTART_OFF="ğŸ›‘ Autostart disabled"
        MSG_AUTOSTART_ERROR="âŒ Failed to setup autostart"
        
        MSG_SOUND_LIST_HEADER="ğŸµ Available Sounds:"
        MSG_SOUND_LIST_BUILTIN="  [Built-in] (Cannot be removed)"
        MSG_SOUND_LIST_CUSTOM="  [Custom]"
        MSG_SOUND_LIST_NONE="  (None)"
        MSG_SOUND_LIST_ITEM_NONE="  - none      : Mute"
        MSG_SOUND_LIST_ITEM_DEFAULT="  - default   : Standard message"
        MSG_SOUND_LIST_ITEM_BELL="  - bell      : Bell"
        MSG_SOUND_LIST_ITEM_COMPLETE="  - complete  : Task complete"
        MSG_SOUND_LIST_ITEM_SUCCESS="  - success   : Success"
        MSG_SOUND_LIST_ITEM_ALARM="  - alarm     : Alarm clock"
        MSG_SOUND_LIST_ITEM_CAMERA="  - camera    : Camera shutter"
        MSG_SOUND_LIST_ITEM_DEVICE="  - device    : Device added"
        MSG_SOUND_LIST_ITEM_ATTENTION="  - attention : Attention"
        
        MSG_SOUND_PLAY_TAG_REQUIRED="âŒ Please specify a tag"
        MSG_SOUND_PLAY_PLAYING="â–¶ï¸  Previewing [%s] : %s"
        MSG_SOUND_PLAY_MUTE="ğŸ”‡ (Muted)"
        MSG_SOUND_PLAY_ERROR="âŒ File not found or cannot play"
        MSG_SOUND_SET_UPDATED="âœ… Sounds updated: Start[%s] -> End[%s]"
        MSG_SOUND_ADD_USAGE="âŒ Usage: eye sound add <tag> <path>"
        MSG_SOUND_ADD_ERROR_BUILTIN="âŒ Error: '%s' is a built-in sound, cannot overwrite."
        MSG_SOUND_ADD_ERROR_FILE="âŒ Error: File not found: %s"
        MSG_SOUND_ADD_CONFIRM_REPLACE="âš ï¸  Tag '%s' already exists, replace? [y/N] "
        MSG_SOUND_ADD_ADDED="âœ… Added: %s"
        MSG_SOUND_RM_USAGE="âŒ Usage: eye sound rm <tag>"
        MSG_SOUND_RM_ERROR_BUILTIN="âŒ Error: '%s' is a built-in sound, cannot remove."
        MSG_SOUND_RM_DELETED="ğŸ—‘ï¸  Deleted sound: %s"
        MSG_SOUND_RM_NOT_FOUND="âš ï¸  Custom tag not found: %s"
        MSG_SOUND_RM_NO_CUSTOM="âš ï¸  No custom configuration"
        MSG_SOUND_ON="ğŸ”Š Sound enabled"
        MSG_SOUND_OFF="ğŸ”‡ Sound disabled"
        MSG_SOUND_USAGE="Usage: eye sound [list|play|set|add|rm|on|off]"
        
        MSG_NOTIFY_TITLE_START="ğŸ‘€ Eye Protection"
        MSG_NOTIFY_BODY_START="Look away for %s!"
        MSG_NOTIFY_TITLE_END="âœ… Break Ended"
        MSG_NOTIFY_BODY_END="Eyes rested. Keep going!"
        MSG_ERROR_INVALID_TIME_FORMAT="Error: Invalid time format"
    fi
}
